<!DOCTYPE html>
<html><head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Copy Tool</title>
<link rel="manifest" href="/manifest.webmanifest">
<link href="./vendor.bundle-d8c8de758e3b1b981defba9685742cfe.css" rel="stylesheet" crossOrigin="anonymous" integrity="sha256-5TMES8QYCWmljIVex2LoZVubwo/S+mUSRgEXAyncvso=">
<style>
*{font-family:"Lucida Grande",Lucida Sans Unicode,Hiragino Sans GB,WenQuanYi Micro Hei,Verdana,Aril,sans-serif;-webkit-font-smoothing:antialiased}input,textarea{font-family:Menlo,Monaco,Consolas,"Courier New",monospace}pre{white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;word-wrap:break-word}.copy-button{width:100%}.row{margin-top:5px}
</style>
</head><body>
<a class="github-fork-ribbon right-bottom" href="https://github.com/plantain-00/copy-tool" title="Fork me on GitHub" target="_blank">Fork me on GitHub</a>
<div class="container">
<div id="body"></div>
<div class="row">
<canvas id="qr"></canvas>
</div>
</div>
<script src="./vendor.bundle-3064ab0714b49c08b3263593e98b42f9.js" crossOrigin="anonymous" integrity="sha256-iQsapBJjlH9JuI7DxULxkHmh46iBz0xpb2MtiJ5VR+4="></script>
<script>
webpackJsonp([0],{114:function(e,n,t){"use strict";t.d(n,"a",function(){return i});var i={dragAndDrop:"通过拖放、",selectFile:"选择",pasteFromClipboard:"、或者从剪切板粘贴来上传文件。"}},41:function(e,n,t){"use strict";function i(){return Math.round(35*Math.random()*Math.pow(36,9)).toString(36)}function o(){return b(new Date,"HH:mm:ss")}function s(){y.toCanvas(document.getElementById("qr"),document.location.href,function(e){e&&console.log(e)})}function a(e){"Notification"in window&&("granted"===Notification.permission?new Notification(e):"denied"!==Notification.permission&&Notification.requestPermission(function(n){"granted"===n&&new Notification(e)}))}function l(e){for(var n=document.cookie.split(";"),t=0,i=n;t<i.length;t++){var o=i[t],s=o.trim().split("=");if(s[0]===e)return s[1]}return""}Object.defineProperty(n,"__esModule",{value:!0});var c,r=t(9),d=t(19),u=(t.n(d),t(12)),p=t.n(u),f=t(16),v=t.n(f),m=t(31),h=(t.n(m),t(72)),g=(t.n(h),t(32)),b=(t.n(g),t(33)),k=(t.n(b),t(95)),y=t(35),C=(t.n(y),t(114)),w=!!window.RTCPeerConnection,x=null;new m(".clipboard");var M=new Worker("worker.bundle.js"),N=function(e){function n(n){var t=e.call(this)||this;t.acceptMessages=[],t.newText="",t.id=1,t.clientCount=0,t.peerConnection=w?new RTCPeerConnection:null,t.dataChannelIsOpen=!1,t.dataChannel=null,t.splitFile=new g.SplitFile,t.files=[],t.speed=100,t.locale=x;var r,u=document.location.hash;u&&"#"!==u?r=u.substr(1):(r=l("room")||i(),document.location.hash="#"+r);var p=function(){t.socket=d("/",{query:{room:r}}),t.socket.on("copy",t.onMessageRecieved),t.socket.on("message_sent",t.onMessageSent),t.socket.on("client_count",t.onClientCount),w&&(t.socket.on("offer",t.onGetOffer),t.socket.on("answer",t.onGetAnswer)),document.cookie="room="+r,s()};return p(),window.onhashchange=function(e){if(e.newURL){var n=e.newURL.indexOf("#");if(n>-1){var i=e.newURL.substring(n+1);r!==i&&(t.socket.disconnect(),r=i,p())}}},t.peerConnection&&(t.dataChannel=t.peerConnection.createDataChannel("copy_tool_channel_name"),t.peerConnection.ondatachannel=function(e){e.channel.onopen=function(e){c.dataChannelIsOpen=!0,t.acceptMessages.unshift({kind:"text",value:"The connection is opened.",moment:o(),id:t.id++})},e.channel.onclose=function(e){c.dataChannelIsOpen=!1,t.acceptMessages.unshift({kind:"text",value:"The connection is closed.",moment:o(),id:t.id++})},e.channel.onmessage=function(e){if("string"==typeof e.data)t.acceptMessages.unshift({kind:"text",value:e.data,moment:o(),id:t.id++}),a("You got a text message!");else{var n=t.splitFile.decodeBlock(new Uint8Array(e.data)),i=t.files.findIndex(function(e){return e.fileName===n.fileName});-1===i&&(i=t.files.length,t.files.push({fileName:n.fileName,blocks:[],progress:0}));var s=t.files[i];if(s.blocks.push({currentBlockIndex:n.currentBlockIndex,binary:n.binary}),s.progress=Math.round(100*s.blocks.length/n.totalBlockCount),s.blocks.length===n.totalBlockCount){s.blocks.sort(function(e,n){return e.currentBlockIndex-n.currentBlockIndex});var l=new File(s.blocks.map(function(e){return e.binary}),n.fileName);t.acceptMessages.unshift({kind:"file",value:l,url:URL.createObjectURL(l),moment:o(),id:t.id++}),t.files.splice(i,1),a("You got a file!")}}}}),t}return r.b(n,e),Object.defineProperty(n.prototype,"canCreateOffer",{get:function(){return w&&!this.dataChannelIsOpen},enumerable:!0,configurable:!0}),n.prototype.onGetAnswer=function(e){var n=new RTCSessionDescription(e.answer);this.peerConnection.setRemoteDescription(n)},n.prototype.onGetOffer=function(e){var n=this,t=new RTCSessionDescription(e.offer);this.peerConnection.setRemoteDescription(t).then(function(){return n.peerConnection.createAnswer()}).then(function(e){return n.peerConnection.setLocalDescription(e)}).then(function(){n.socket.emit("answer",{sid:e.sid,answer:n.peerConnection.localDescription.toJSON()})})},n.prototype.tryToConnect=function(){var e=this;this.peerConnection&&this.peerConnection.createOffer().then(function(n){return e.peerConnection.setLocalDescription(n)}).then(function(){e.socket.emit("offer",e.peerConnection.localDescription.toJSON())})},n.prototype.onMessageRecieved=function(e){if("file"===e.kind){var n=new File([e.value],e.name,{type:e.type});this.acceptMessages.unshift({kind:"file",value:n,url:URL.createObjectURL(n),moment:o(),id:this.id++}),a("You got a file!")}else e.moment=o(),e.id=this.id++,this.acceptMessages.unshift(e),a("You got a text message!")},n.prototype.onMessageSent=function(e){this.acceptMessages.unshift({kind:"text",value:"the "+e.kind+" is sent successfully to "+this.clientCount+" clients.",moment:o(),id:this.id++})},n.prototype.onClientCount=function(e){this.clientCount=e.clientCount},Object.defineProperty(n.prototype,"buttonText",{get:function(){return this.clientCount>0?"Copy the text to "+this.clientCount+" clients":"No clients to sent"},enumerable:!0,configurable:!0}),n.prototype.copyText=function(){if(this.clientCount<=0)return void this.acceptMessages.unshift({kind:"text",value:"No clients to sent.",moment:o(),id:this.id++});if(!this.newText)return void this.acceptMessages.unshift({kind:"text",value:"No text to sent.",moment:o(),id:this.id++});if(this.dataChannelIsOpen)this.dataChannel.send(this.newText);else{var e={kind:"text",value:this.newText};this.socket.emit("copy",e)}this.newText=""},n.prototype.fileGot=function(e){if(this.clientCount<=0)return void this.acceptMessages.unshift({kind:"text",value:"No clients to sent.",moment:o(),id:this.id++});var n=e.type.split("/")[1],t=e.name||"no name."+n;if(this.dataChannelIsOpen){var i={kind:"split file",file:e,fileName:t};M.postMessage(i)}else{if(e.size>=10485760)return void this.acceptMessages.unshift({kind:"text",value:"the file is too large(>= 10MB).",moment:o(),id:this.id++});this.socket.emit("copy",{kind:"file",value:e,name:t,type:e.type})}},n=r.a([v.a({template:k.a})],n)}(p.a),O=[];setInterval(function(){O.length>0&&O.splice(0,c.speed).forEach(function(e){c.dataChannel.send(e)})},1e3),M.onmessage=function(e){var n=e.data;"split file result"===n.kind&&O.push.apply(O,n.blocks)},navigator.serviceWorker&&navigator.serviceWorker.register("service-worker.bundle.js").catch(function(e){console.log("registration failed with error: "+e)}),"zh-CN"===navigator.language&&(x=C.a),function(){c=new N({el:"#body"})}()},72:function(e,n,t){"use strict"},95:function(e,n,t){"use strict";t.d(n,"a",function(){return i});var i='<div><div class="row"><div class="col-md-12"><h4>Copy-Tool</h4></div></div><div class="row"><div class="col-md-12"><textarea class="form-control" rows="5" v-model="newText"></textarea></div></div><div class="row"><div class="col-md-12"><button class="btn btn-primary copy-button" @click="copyText()">{{buttonText}}</button></div></div><div class="row" v-if="canCreateOffer"><div class="col-md-12"><button class="btn btn-default copy-button" @click="tryToConnect()">try to connect</button></div></div><div class="row" v-for="(file, index) in files"><div class="col-md-12"><div class="progress"><div class="progress-bar progress-bar-success" role="progressbar" :aria-valuenow="file.progress" aria-valuemin="0" aria-valuemax="100" :style="\'width:\' + file.progress + \'%\'">{{file.fileName}}</div></div></div></div><div class="row"><div class="col-md-12"><label class="radio-inline"><input type="radio" v-model="speed" value="10"> 100KB/s</label><label class="radio-inline"><input type="radio" v-model="speed" value="20"> 200KB/s</label><label class="radio-inline"><input type="radio" v-model="speed" value="50"> 500KB/s</label><label class="radio-inline"><input type="radio" v-model="speed" value="100"> 1MB/s</label><label class="radio-inline"><input type="radio" v-model="speed" value="200"> 2MB/s</label><label class="radio-inline"><input type="radio" v-model="speed" value="500"> 5MB/s</label><label class="radio-inline"><input type="radio" v-model="speed" value="1000"> 10MB/s</label><label class="radio-inline"><input type="radio" v-model="speed" value="Infinity"> No limit(Will block the UI)</label></div></div><div class="row"><div class="col-md-12"><file-uploader @file-got="fileGot($event)" multiple="true" :locale="locale"></file-uploader></div></div><div class="row"><div class="col-md-12"><ul><li v-for="(message, index) in acceptMessages"><span class="label label-default">{{message.moment}}</span><span class="label label-info">{{message.kind}}</span><button v-if="message.kind === \'text\'" class="btn btn-xs btn-default clipboard" :data-clipboard-target="\'#clipboard_\' + message.id">copy</button><pre v-if="message.kind === \'text\'" :id="\'clipboard_\' + message.id">{{message.value}}</pre><a v-if="message.kind === \'file\'" class="btn btn-link" :href="message.url" :download="message.value.name">{{message.value.name}}</a></li></ul></div></div></div>'}},[41]);
</script>
</body></html>